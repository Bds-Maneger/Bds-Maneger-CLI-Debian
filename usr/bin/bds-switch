#! /bin/bash
cd /etc/BDS-Common/worlds/
# Var
MENU="Mapa"
TITLE="Selecione um Mapa?"
BACK=""
TAMANHO="0 0 0"
# Var

# Init
if [ -e /etc/bds-maneger/bds-swith ]
then
 for cOs in $(ls)
 do
   cp /usr/opt/bds-maneger/server.properties ${Cos}/server.properties
   sed -i "s|level-name=New_World|level-name=$(echo ${Cos} | sed 's|/||g')|g" ${Cos}/server.properties
 done
 echo "done" > /etc/bds-maneger/bds-swith
else
 echo "Nãp precissamos lista os mapas e configurar continuando ..."
fi

shopt -s nullglob
arr=(*)
for ((i=0; i<${#arr[@]}; i++)); do j=$((2*$i+2)); a[j]="${arr[$i]}"; a[j+1]=""; done
# Next line has extra spaces at right to try to center it:
MPA=$(whiptail --ok-button "OK" --cancel-button "Cancelar" --title "$TITLE" --backtitle "$BACK" --menu "$MENU" $TAMANHO "${a[@]}" 2>&1 >/dev/tty)
if [[ $? = 0 ]]
then
# ge 5 in next line should be length of file extension including . character, plus 1
  [ ${#MPA} -ge 5 ] && outfile="$MPA" || echo "Selection not made"
fi
echo "O mapa Selecionado foi: $MPA , alterando configurações do servidor e o Mapa ..."
cat "$MPA" > /etc/BDS-Common/server.properties